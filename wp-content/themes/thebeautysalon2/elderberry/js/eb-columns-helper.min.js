function reset_columns(){jQuery(".layout-creator .row *").not(".default-message").appendTo(".eb-columns-helper .columns .row:first");balance_col_types();balance_elements(jQuery(".eb-columns-helper .columns"));update_column_statuses(0);jQuery(".layout-creator .row").html('<div class="default-message">Drag columns from above in here</div>')}function set_sortables(){jQuery(".eb-columns-helper .columns .row").sortable({connectWith:".layout-creator .row",items:":not(.disabled)",tolerance:"pointer",receive:function(){var e=get_total_length();balance_col_types();balance_elements(jQuery(".eb-columns-helper .columns"));update_column_statuses(e);e===0&&jQuery(".layout-creator .row").html('<div class="default-message">Drag columns from above in here</div>')}});jQuery(".layout-creator .row").sortable({connectWith:".eb-columns-helper .columns .row",placeholder:"placeholder twocol",tolerance:"pointer",over:function(){jQuery(".layout-creator .default-message").remove()},receive:function(){var e=get_total_length();balance_elements(jQuery(".layout-creator"));update_column_statuses(e)},update:function(){jQuery(".layout-creator .row *").removeClass("last");jQuery(".layout-creator .row *:last").addClass("last")}})}function balance_col_types(){var e="",t="";jQuery.each(jQuery(".eb-columns-helper .columns .row"),function(){e=jQuery(this).attr("data-col");jQuery.each(jQuery(this).find("*"),function(){t=jQuery(this).attr("data-col");t!=e&&jQuery(this).prependTo('.eb-columns-helper .columns .row[data-col="'+t+'"]')})})}function update_column_statuses(e){jQuery.each(jQuery(".eb-columns-helper .columns .row *"),function(){var t=parseFloat(jQuery(this).html()),n=12-e;t>n?jQuery(this).addClass("disabled"):jQuery(this).removeClass("disabled")})}function get_total_length(){var e=0,t=0;jQuery.each(jQuery(".layout-creator .row *"),function(){t=parseFloat(jQuery(this).html());e=t+e});return e}function balance_elements(e){jQuery.each(e.find(".row"),function(){jQuery(this).find("*").removeClass("last");jQuery(this).find("*:last").addClass("last")})}var tinymce,tb_show,tinyMCE,tb_remove;(function(){tinymce.create("tinymce.plugins.ebColumns",{init:function(e,t){e.addButton("ebColumns",{title:"Create Columns",onclick:function(){tb_show("Columns Helper","#TB_inline?inlineId=eb-columns-helper");reset_columns()}})},createControl:function(e,t){return null},getInfo:function(){return{longname:"Elderberry Layout Builder",author:"Elderberry"}}});tinymce.PluginManager.add("ebColumns",tinymce.plugins.ebColumns)})();jQuery(document).ready(function(){jQuery(".eb-columns-helper").submit(function(e){e.preventDefault();if(jQuery(".layout-creator .row *").length==1&&jQuery(".layout-creator .row *:first").hasClass("default-message"))alert("Please add some columns before you continue");else{var t=jQuery(jQuery(".layout-creator .row")).clone();t.removeClass("ui-sortable");t.find("*").removeAttr("data-col").html("column content");t='<div class="row columns">'+t.html()+"</div> You can also write underneath, or create a new columned layout";tinyMCE.activeEditor.execCommand("mceReplaceContent",!1,t);reset_columns();tb_remove()}});set_sortables()});